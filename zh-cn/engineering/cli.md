# ç”¨ one-cli å¿«é€Ÿæ­å»ºä¸€å¥—è‡ªå·±çš„ cli

> åœ¨æ­¤æ¨è [one-cli](https://github.com/developer-ones/onecli) è¿›è¡Œè‡ªå·±çš„å®šåˆ¶ï¼Œå®Œæˆè‡ªå·±å›¢é˜Ÿä¸“å± cli å·¥å…·çš„èµ·æ­¥

## ä»‹ç»
ä»€ä¹ˆæ˜¯ Cli ï¼Ÿå…¨ç§°å°±æ˜¯ command-line interfaceï¼Œå³å‘½ä»¤è¡Œå·¥å…·ï¼Œè¾“å…¥ä¸€è¡Œå‘½ä»¤ï¼Œé€šè¿‡ä¸€äº›äº¤äº’æ“ä½œï¼Œå¸®ä½ æ­å»ºé¡¹ç›®è„šæ‰‹æ¶ã€‚

cli ä½œä¸ºé¡¹ç›®åˆå§‹åŒ–çš„æ—¶å¤§å¹…å¸®åŠ©å›¢é˜ŸåŒå­¦æå‡å¹¸ç¦æ„Ÿçš„å·¥å…·ï¼Œæˆ‘ä»¬ç›¸ä¿¡æ­£åœ¨é˜…è¯»è¿™ç¯‡æ–‡ç« çš„å¼€å‘è€…æˆ–å¤šæˆ–å°‘çš„ä½¿ç”¨è¿‡å„ç§ cli æˆ–è€…åœ¨å…¶ä»–çš„åœ°æ–¹é˜…è¯»è¿‡å„ç§æœ‰å…³ cli çš„æ–‡ç« ã€‚

ä½†è¿™é‡Œæˆ‘ä»¬æƒ³æä¾›ä¸€ä¸ªæ›´ç®€å•ã€å¼€ç®±å³ç”¨çš„å·¥å…·ğŸ‘‰  [one-cli](https://github.com/developer-ones/onecli) ã€‚one-cli ç›®å‰æ”¯æŒ init ä¸ create å‘½ä»¤ï¼Œä½œç”¨åˆ†åˆ«ä¸º **ã€Œé¡¹ç›®å¯åŠ¨æ—¶ => åˆ›å»ºé¡¹ç›®æ¨¡ç‰ˆã€** ä¸ **ã€Œé¡¹ç›®å¼€å‘ä¸­ => éœ€è¦æ–°é¡µé¢åˆ›å»ºæ¨¡ç‰ˆé¡µé¢ & ç»„ä»¶ã€** çš„åŠŸèƒ½ã€‚è¿™ä¸¤ä¸ªå‘½ä»¤å¯ä»¥è¦†ç›–å›¢é˜Ÿä¸­å¯¹ cli éœ€æ±‚çš„å¤§éƒ¨åˆ†åœºæ™¯ã€‚

åŒæ—¶æˆ‘ä»¬å¸Œæœ› one-cli å¯ä»¥æˆä¸ºèƒ½å¸®åŠ©ä¸­å°å›¢é˜Ÿ **ã€Œè§£å†³å›¢é˜Ÿå·¥ç¨‹åŒ–çš„ç¬¬ä¸€æ­¥ã€**ã€‚one-cli çš„å¦ä¸€å¤§ç›®åœ°å°±æ˜¯ï¼Œå°†å·¥ç¨‹åŒ–èƒ½åŠ›ä¸­çš„ cli å·¥å…·ğŸ”§ ä»¥æ¨¡ç‰ˆçš„å½¢å¼æä¾›ç»™å¼€å‘è€…ã€‚ä½¿å¼€å‘è€…å¯ä»¥ç»è¿‡ç®€å•çš„ ä¿®æ”¹/æ·»åŠ æ¨¡ç‰ˆ ä¹‹åå°±å˜æˆèƒ½å›¢é˜Ÿä¸“å±å®šåˆ¶å·¥å…·ã€‚

## å¿«é€Ÿä¸Šæ‰‹

one-cli çš„ä½¿ç”¨ç›¸å½“ç®€å•ï¼Œå…¨å±€å®‰è£… one-cli å·¥å…· ï¼Œå¹¶ç›´æ¥æ ¹æ®éœ€è¦æ‰§è¡Œ init/create å‘½ä»¤

```
npm i @developer-ones/onecli -g

mkdir myapp && cd myapp

# å½“å‰æ–‡ä»¶è·¯å¾„ä¸‹ åˆå§‹åŒ–é¡¹ç›®
one init

# å½“å‰æ–‡ä»¶è·¯å¾„ä¸‹ åˆ›å»ºæ¨¡å—
one create
```

### init
é¦–å…ˆå¯¹ one init åŠŸèƒ½çš„å®šä¹‰æ˜¯å¼€å‘è€…ç›´æ¥ä½¿ç”¨ init å‘½ä»¤è¿›è¡Œé¡¹ç›®çš„åˆå§‹åŒ–ã€‚å¸Œæœ›èƒ½é€šè¿‡ cli è¿™ç§ç»Ÿä¸€çš„å…¥å£ç”Ÿæˆçš„é¡¹ç›®ï¼Œä¿æŒå¯¹å›¢é˜Ÿåˆå§‹åŒ–æ¨¡æ¿çš„ç»Ÿä¸€å’ŒèŠ‚çœå›¢é˜Ÿæˆå‘˜å¯¹é¡¹ç›®åˆå§‹åŒ–é…ç½®çš„å¤§é‡æ—¶é—´ã€‚è¿™æ ·ä½¿ç”¨è€…æ— éœ€å…³å¿ƒæ¨¡ç‰ˆä¸­æ²¡æœ‰ä½¿ç”¨åˆ°çš„ä¸€äº›è¯¦ç»†é…ç½®å’Œç»†èŠ‚ï¼Œä¿æŒäº†æœ€å¤§ç¨‹åº¦çš„å¼€ç®±å³ç”¨ï¼Œé¿å…é‡å¤é…ç½®çš„å·¥ä½œï¼ŒåŒæ—¶é€šè¿‡ cli åˆ›å»ºçš„é¡¹ç›®çœå»ä¼ ç»Ÿ

```
# åœ¨å½“å‰ç›®å½•ä¸‹ç›´æ¥åˆ›å»ºæ–°é¡¹ç›®
one init
```

![one-cli init](https://cdn.dev-one.cn/one-cli%20init.png)

one-cli æä¾›çš„ init å‘½ä»¤ä¾èµ–äº [download-git-repo](https://www.npmjs.com/package/download-git-repo)ï¼Œinit ä¼šæ ¹æ®ä½¿ç”¨è€…çš„è¾“å…¥ download å¯¹åº”çš„ä»£ç ä»“åº“åˆ°æœ¬åœ°ã€‚ï¼ˆè¯·ç¡®ä¿æœ¬åœ°é…ç½®å¥½ node ç¯å¢ƒä¸ gitï¼‰

## create

one create åŠŸèƒ½ä¸»è¦æ˜¯åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­éœ€è¦æ·»åŠ æ–°çš„ é¡µé¢/ç»„ä»¶/i18n æˆ–å…¶ä»–æ–°å¢æ–‡ä»¶ï¼Œä½¿ç”¨è€…å¯ä»¥é€šè¿‡ one create å®Œæˆå¯¹æ‰€éœ€æ¨¡å—çš„æ–°å¢

![one-cli create](https://cdn.dev-one.cn/one-cli%20create.png)


ä¸ init å‘½ä»¤ ä¸åŒçš„æ˜¯ï¼Œcreate å‘½ä»¤ä¸»è¦æ˜¯ç›´æ¥åœ¨æœ¬åœ°å†™å…¥ template æ–‡ä»¶å¤¹ä¸­çš„å†…å®¹å®Œæˆçš„ã€‚

## å¼€å‘

æˆ‘ä»¬å°† one-cli æ‰“é€ æˆä¸€æ¬¾é€šç”¨çš„ cli å·¥å…·ï¼Œç›®å‰æä¾› init ä¸ create å‘½ä»¤ã€‚å¼€å‘è€…å¯ä»¥é€šè¿‡ç®€å•çš„ä¿®æ”¹å®Œæˆè‡ªå·±çš„ cli å®šåˆ¶ã€‚

### ç›®å½•ç»“æ„

```
â”œâ”€â”€ bin                                 // bin ç›®å½•
â”‚Â Â  â””â”€â”€ init.js                         // æ‰§è¡Œå‘½ä»¤è¡Œ commanderï¼Œä¾‹å¦‚ one init ã€one create
â”œâ”€â”€ src
â”‚Â Â  â”œâ”€â”€ commands                        // commands å…·ä½“å®ç°
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ create.ts                   // create åŠŸèƒ½
â”‚Â Â  â”‚Â Â  â””â”€â”€ init.ts                     // init åŠŸèƒ½
â”‚Â Â  â”œâ”€â”€ config.json                     // å¯ä»¥åœ¨è¿™é‡Œæ–°å¢ template address
â”‚Â Â  â”œâ”€â”€ template                        // template file
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ index.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tpl-component.tsx.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tpl-i18n.js.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tpl-index.less.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tpl-index.md.ts
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ tpl-index.ts.ts
â”‚Â Â  â”‚Â Â  â””â”€â”€ tpl-page.tsx.ts
â”‚Â Â  â””â”€â”€ utils
â”‚Â Â      â””â”€â”€ index.ts
```

ä»¥ init ä¸ºä¾‹ï¼Œå…¶ä¸»è¦åŠŸèƒ½åœ¨ /src/commands/init.ts ä¸‹,

1. å¯ä»¥é€šè¿‡ä¿®æ”¹ question ä¸­çš„ template çš„ choices ä¸­æ–°å¢é€‰é¡¹ä½œä¸ºç”¨æˆ·åœ¨æ‰§è¡Œ init å‘½ä»¤æ˜¯äº¤äº’è¯¢é—®æ—¶å€™çš„é€‰æ‹©ã€‚
2. ä¹‹ååœ¨ /src/config.json ä¸­æ–°å¢å¯¹åº”çš„ choices[item].value çš„é…ç½®ï¼Œå°±å¯ä»¥å®Œæˆå¯¹ init å‘½ä»¤çš„å®šåˆ¶åŒ–æ”¹é€ ï¼Œä»¥ç¬¦åˆå¼€å‘è€…çš„å›¢é˜Ÿå®é™…éœ€æ±‚ã€‚
3. åŒæ—¶ question ä¸­æˆ‘ä»¬æä¾›äº†ä¸€äº›é¡¹ç›®åŸºç¡€ä¿¡æ¯çš„è¾“å…¥é…ç½®ï¼Œå¯ä»¥åœ¨ question ä¸­æ–°å¢æ–°çš„é—®é¢˜å®Œæˆæ›´é€‚åˆå›¢é˜Ÿéœ€æ±‚çš„é…ç½®ã€‚

### bin name

bin name æ˜¯ cli å·¥å…·åœ¨ä½¿ç”¨è€…æœ¬åœ°ç¯å¢ƒå‘½ä»¤è¡Œä¸­è§¦å‘å‘½ä»¤ï¼Œå¯ä»¥é€šè¿‡ package.json ä¸­çš„ bin è¿›è¡Œä¿®æ”¹æ¥å®ç°è‡ªå®šä¹‰ï¼Œæ­¤å¤„å¯ä»¥å°† "one" ä¿®æ”¹æˆä»»æ„çš„å…³é”®è¯ xxxï¼Œä¹‹ååœ¨å‘½ä»¤è¡Œä¸­çš„ä½¿ç”¨å°±å˜æˆ xxx init æˆ– xxx create

![bin-name](https://cdn.dev-one.cn/bin-name.png)

### æµ‹è¯•
åœ¨å®Œæˆæœ¬åœ°å¼€å‘ä¹‹åæ‰§è¡Œ npm run build æ‰“åŒ…ï¼Œä¼šåœ¨ lib ä¸‹ç”Ÿæˆæ‰“åŒ…çš„ç»“æœï¼Œåœ¨ cli é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ‰§è¡Œ npm link å‘½ä»¤å°†æœ¬åœ°å¼€å‘åŒ…é“¾æ¥åˆ°å…¨å±€ï¼Œè¿™æ ·å¯ä»¥æ¨¡æ‹ŸçœŸå®å‘å¸ƒåˆ° npm ä¹‹åæœ¬åœ° install -g çš„æ•ˆæœã€‚

```
# æ·»åŠ é“¾æ¥
npm link

# éªŒè¯
one -V
// ä¼šè¾“å‡º package.json ä¸­çš„version: 1.0.0
// æ­¤å¤„æœ‰è¾“å‡ºè¯æ˜ npm link æ‰§è¡ŒæˆåŠŸ

# å–æ¶ˆé“¾æ¥
npm unlink <package-name>
```

### å‘å¸ƒ
åœ¨æœ¬åœ°æ‰“åŒ…éªŒè¯å®Œä¹‹åï¼Œå¯ä»¥é€šè¿‡ npm publish çš„æ–¹å¼å‘å¸ƒåˆ° ç§æœ‰/å…¬å…± npm ä»“åº“ä¸­ï¼Œè¿™æ ·ä½ çš„ cli å·¥å…·å°±å¯ä»¥è¢«å…¶ä»–å°ä¼™ä¼´é€šè¿‡ npm çš„æ–¹å¼å®‰è£…åˆ°æœ¬åœ°ï¼Œæ–¹ä¾¿çš„ä½¿ç”¨å•¦ã€‚

```
npm run build

npm publish

# å¦‚æœä½ æƒ³å‘å¸ƒåœ¨ä¾‹å¦‚ @developer-ones è¿™æ ·çš„å…¬å¼€ç»„ç»‡ä¸‹é¢éœ€è¦æºå¸¦ --access public
npm publish --access public
```
